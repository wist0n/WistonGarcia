

$diskInfo = Get-WmiObject Win32_DiskDrive | ForEach-Object {
    $disk = $_
    $partitions = @(Get-WmiObject -Query "ASSOCIATORS OF {Win32_DiskDrive.DeviceID='$($disk.DeviceID)'} WHERE AssocClass=Win32_DiskDriveToDiskPartition")
    
    foreach ($partition in $partitions) {
        $volumes = @(Get-WmiObject -Query "ASSOCIATORS OF {Win32_DiskPartition.DeviceID='$($partition.DeviceID)'} WHERE AssocClass=Win32_LogicalDiskToPartition")
        
        foreach ($volume in $volumes) {
            [PSCustomObject]@{
                DiscoFisico     = $disk.DeviceID
                Modelo          = $disk.Model
                SCSI_Bus        = $disk.SCSIBus
                SCSI_TargetID   = $disk.SCSITargetId
                Tamano_GB       = [math]::Round($disk.Size / 1GB, 2)
                LetraUnidad     = $volume.DeviceID
                Etiqueta        = $volume.VolumeName
            }
        }
    }
}


$diskInfo | Sort-Object SCSI_Bus, SCSI_TargetID | Format-Table -AutoSize
